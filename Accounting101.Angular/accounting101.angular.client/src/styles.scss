@use '@angular/material' as mat;
@use 'sass:map';
@use './styles/styles_theme-colors.scss' as theme-colors;

// Define the theme with only valid properties
$theme: (
  color: (
    primary: theme-colors.$primary-palette,
    tertiary: theme-colors.$tertiary-palette,
    theme-type: light
  ),
  typography: Roboto,
  density: 0
);

// Apply the theme to the html element
html {
  @include mat.theme($theme);
}

html, body { height: 100%; }
body {
  margin: 0;
  font-family: Roboto, "Helvetica Neue", sans-serif;
  background-color: var(--mat-surface-container);
  color: var(--mat-on-surface);
}
body.inheritCursors * { cursor: inherit !important; }

// Define custom color tokens based on Material Design 3
:root {
  // Spacing tokens
  --md-sys-spacing-small: 8px;
  --md-sys-spacing-medium: 16px;
  --md-sys-spacing-large: 24px;
  --md-sys-spacing-extra-large: 32px;

  // Elevation tokens
  --md-sys-elevation-level1: 0px 1px 3px 0px rgba(0, 0, 0, 0.12);
  --md-sys-elevation-level2: 0px 3px 6px 0px rgba(0, 0, 0, 0.15);
  --md-sys-elevation-level3: 0px 6px 12px 0px rgba(0, 0, 0, 0.18);

  // Border radius tokens
  --md-sys-shape-small: 4px;
  --md-sys-shape-medium: 8px;
  --md-sys-shape-large: 12px;
  --md-sys-shape-extra-large: 16px;
  --md-sys-shape-full: 9999px;

  // Color tokens
  --md-sys-color-primary: #565f6e;
  --md-sys-color-primary-rgb: 86, 95, 110;
  --md-sys-color-on-primary: #ffffff;
  --md-sys-color-on-primary-rgb: 255, 255, 255;
  --md-sys-color-primary-container: #dbe3f4;
  --md-sys-color-primary-container-rgb: 219, 227, 244;
  --md-sys-color-on-primary-container: #141c28;
  --md-sys-color-on-primary-container-rgb: 20, 28, 40;

  --md-sys-color-secondary: #5c5e65;
  --md-sys-color-secondary-rgb: 92, 94, 101;
  --md-sys-color-on-secondary: #ffffff;
  --md-sys-color-on-secondary-rgb: 255, 255, 255;
  --md-sys-color-secondary-container: #e1e2ea;
  --md-sys-color-secondary-container-rgb: 225, 226, 234;
  --md-sys-color-on-secondary-container: #191c21;
  --md-sys-color-on-secondary-container-rgb: 25, 28, 33;

  --md-sys-color-tertiary: #695a69;
  --md-sys-color-tertiary-rgb: 105, 90, 105;
  --md-sys-color-on-tertiary: #ffffff;
  --md-sys-color-on-tertiary-rgb: 255, 255, 255;
  --md-sys-color-tertiary-container: #f1dcef;
  --md-sys-color-tertiary-container-rgb: 241, 220, 239;
  --md-sys-color-on-tertiary-container: #231825;
  --md-sys-color-on-tertiary-container-rgb: 35, 24, 37;

  --md-sys-color-error: #ba1a1a;
  --md-sys-color-error-rgb: 186, 26, 26;
  --md-sys-color-on-error: #ffffff;
  --md-sys-color-on-error-rgb: 255, 255, 255;
  --md-sys-color-error-container: #ffdad6;
  --md-sys-color-error-container-rgb: 255, 218, 214;
  --md-sys-color-on-error-container: #410002;
  --md-sys-color-on-error-container-rgb: 65, 0, 2;

  --md-sys-color-surface: #fdfcff;
  --md-sys-color-surface-rgb: 253, 252, 255;
  --md-sys-color-on-surface: #1b1b1c;
  --md-sys-color-on-surface-rgb: 27, 27, 28;
  --md-sys-color-surface-variant: #e1e2e8;
  --md-sys-color-surface-variant-rgb: 225, 226, 232;
  --md-sys-color-on-surface-variant: #45474c;
  --md-sys-color-on-surface-variant-rgb: 69, 71, 76;

  --md-sys-color-outline: #75777c;
  --md-sys-color-outline-rgb: 117, 119, 124;
  --md-sys-color-background: #fdfcff;
  --md-sys-color-background-rgb: 253, 252, 255;
  --md-sys-color-on-background: #1b1b1c;
  --md-sys-color-on-background-rgb: 27, 27, 28;
}

menu {
  background-color: var(--md-sys-color-surface);
}

// Component overrides using Material Design 3 tokens
:root {
  // Apply component overrides using Material Design 3 tokens
  @include mat.menu-overrides((
    container-color: var(--md-sys-color-surface),
    item-label-text-color: var(--md-sys-color-on-surface)
  ));

  @include mat.card-overrides((
    // Color
    subtitle-text-color: var(--md-sys-color-on-surface-variant),
    elevated-container-color: var(--md-sys-color-surface),
    elevated-container-elevation: var(--md-sys-elevation-level1),
    outlined-container-color: var(--md-sys-color-surface),
    outlined-outline-color: var(--md-sys-color-outline),

    // Shape
    elevated-container-shape: 12px,
    outlined-container-shape: 12px
  ));

  @include mat.button-overrides((
    // Color
    filled-container-color: var(--md-sys-color-primary),
    filled-label-text-color: var(--md-sys-color-on-primary),
    text-label-text-color: var(--md-sys-color-on-surface),
    outlined-outline-color: var(--md-sys-color-outline),

    // Shape
    filled-container-shape: 20px,
    outlined-container-shape: 20px,
    text-container-shape: 20px,

    // Animation
    hover-state-layer-opacity: 0.08,
    pressed-state-layer-opacity: 0.12
  ));

  @include mat.form-field-overrides((
    // Color
    outlined-caret-color: var(--md-sys-color-primary),
    outlined-input-text-color: var(--md-sys-color-on-surface),
    outlined-label-text-color: var(--md-sys-color-on-surface-variant),
    outlined-outline-color: var(--md-sys-color-outline),

    // Shape
    outlined-container-shape: 4px
  ));

  @include mat.table-overrides((
    // Color
    background-color: var(--md-sys-color-surface),
    row-item-label-text-color: var(--md-sys-color-on-surface),
    header-headline-color: var(--md-sys-color-on-surface-variant),
    row-item-outline-color: var(--md-sys-color-outline)
  ));

  @include mat.select-overrides((
    // Color
    panel-background-color: var(--md-sys-color-surface),
    enabled-trigger-text-color: var(--md-sys-color-on-surface),

    // Shape
    // container-shape: 4px
  ));

  // Dialog-specific variables using Material Design 3 tokens
  --dialog-background: var(--md-sys-color-surface);
  --dialog-title-color: var(--md-sys-color-on-surface);
  --dialog-content-color: var(--md-sys-color-on-surface-variant);
  --dialog-button-color: var(--md-sys-color-primary);
  --dialog-form-label-color: var(--md-sys-color-on-surface-variant);
  --dialog-form-border-color: var(--md-sys-color-outline);
  --dialog-placeholder-color: rgba(0, 0, 0, 0.42);
  --dialog-icon-color: var(--md-sys-color-on-surface-variant);
  --dialog-input-color: var(--md-sys-color-on-surface);
}

// Table column utilities
.date-column-header {
  --column-width: 10vw;
  flex-basis: 0;
  flex-shrink: 0;
  max-width: var(--column-width);
  min-width: var(--column-width);
}

.date-column {
  flex-basis: 0;
  flex-shrink: 0;
  max-width: var(--column-width);
  min-width: var(--column-width);
}

// Utility classes
.mat-app-background {
  background-color: var(--md-sys-color-surface);
  color: var(--md-sys-color-on-surface);
}

// Text alignment utilities
.right-aligned-header {
  text-align: right;
}

.text-center {
  text-align: center;
}

.text-right {
  text-align: right;
}

// Spacing utilities
.m-0 { margin: 0 !important; }
.mt-0 { margin-top: 0 !important; }
.mr-0 { margin-right: 0 !important; }
.mb-0 { margin-bottom: 0 !important; }
.ml-0 { margin-left: 0 !important; }

.m-1 { margin: var(--md-sys-spacing-small) !important; }
.mt-1 { margin-top: var(--md-sys-spacing-small) !important; }
.mr-1 { margin-right: var(--md-sys-spacing-small) !important; }
.mb-1 { margin-bottom: var(--md-sys-spacing-small) !important; }
.ml-1 { margin-left: var(--md-sys-spacing-small) !important; }

.m-2 { margin: var(--md-sys-spacing-medium) !important; }
.mt-2 { margin-top: var(--md-sys-spacing-medium) !important; }
.mr-2 { margin-right: var(--md-sys-spacing-medium) !important; }
.mb-2 { margin-bottom: var(--md-sys-spacing-medium) !important; }
.ml-2 { margin-left: var(--md-sys-spacing-medium) !important; }

.m-3 { margin: var(--md-sys-spacing-large) !important; }
.mt-3 { margin-top: var(--md-sys-spacing-large) !important; }
.mr-3 { margin-right: var(--md-sys-spacing-large) !important; }
.mb-3 { margin-bottom: var(--md-sys-spacing-large) !important; }
.ml-3 { margin-left: var(--md-sys-spacing-large) !important; }

// Padding utilities
.p-0 { padding: 0 !important; }
.pt-0 { padding-top: 0 !important; }
.pr-0 { padding-right: 0 !important; }
.pb-0 { padding-bottom: 0 !important; }
.pl-0 { padding-left: 0 !important; }

.p-1 { padding: var(--md-sys-spacing-small) !important; }
.pt-1 { padding-top: var(--md-sys-spacing-small) !important; }
.pr-1 { padding-right: var(--md-sys-spacing-small) !important; }
.pb-1 { padding-bottom: var(--md-sys-spacing-small) !important; }
.pl-1 { padding-left: var(--md-sys-spacing-small) !important; }

.p-2 { padding: var(--md-sys-spacing-medium) !important; }
.pt-2 { padding-top: var(--md-sys-spacing-medium) !important; }
.pr-2 { padding-right: var(--md-sys-spacing-medium) !important; }
.pb-2 { padding-bottom: var(--md-sys-spacing-medium) !important; }
.pl-2 { padding-left: var(--md-sys-spacing-medium) !important; }

.p-3 { padding: var(--md-sys-spacing-large) !important; }
.pt-3 { padding-top: var(--md-sys-spacing-large) !important; }
.pr-3 { padding-right: var(--md-sys-spacing-large) !important; }
.pb-3 { padding-bottom: var(--md-sys-spacing-large) !important; }
.pl-3 { padding-left: var(--md-sys-spacing-large) !important; }

// Color utilities
.text-primary { color: var(--md-sys-color-primary) !important; }
.text-on-primary { color: var(--md-sys-color-on-primary) !important; }
.text-secondary { color: var(--md-sys-color-secondary) !important; }
.text-on-secondary { color: var(--md-sys-color-on-secondary) !important; }
.text-tertiary { color: var(--md-sys-color-tertiary) !important; }
.text-on-tertiary { color: var(--md-sys-color-on-tertiary) !important; }
.text-error { color: var(--md-sys-color-error) !important; }
.text-on-surface { color: var(--md-sys-color-on-surface) !important; }
.text-on-surface-variant { color: var(--md-sys-color-on-surface-variant) !important; }

.bg-primary { background-color: var(--md-sys-color-primary) !important; }
.bg-primary-container { background-color: var(--md-sys-color-primary-container) !important; }
.bg-secondary { background-color: var(--md-sys-color-secondary) !important; }
.bg-secondary-container { background-color: var(--md-sys-color-secondary-container) !important; }
.bg-tertiary { background-color: var(--md-sys-color-tertiary) !important; }
.bg-tertiary-container { background-color: var(--md-sys-color-tertiary-container) !important; }
.bg-surface { background-color: var(--md-sys-color-surface) !important; }
.bg-surface-variant { background-color: var(--md-sys-color-surface-variant) !important; }
.bg-error { background-color: var(--md-sys-color-error) !important; }

// Elevation utilities
.elevation-1 { box-shadow: var(--md-sys-elevation-level1) !important; }
.elevation-2 { box-shadow: var(--md-sys-elevation-level2) !important; }
.elevation-3 { box-shadow: var(--md-sys-elevation-level3) !important; }

// Shape utilities
.rounded-small { border-radius: var(--md-sys-shape-small) !important; }
.rounded-medium { border-radius: var(--md-sys-shape-medium) !important; }
.rounded-large { border-radius: var(--md-sys-shape-large) !important; }
.rounded-extra-large { border-radius: var(--md-sys-shape-extra-large) !important; }
.rounded-full { border-radius: var(--md-sys-shape-full) !important; }

// Display utilities
.d-flex { display: flex !important; }
.d-inline-flex { display: inline-flex !important; }
.flex-row { flex-direction: row !important; }
.flex-column { flex-direction: column !important; }
.justify-content-start { justify-content: flex-start !important; }
.justify-content-end { justify-content: flex-end !important; }
.justify-content-center { justify-content: center !important; }
.justify-content-between { justify-content: space-between !important; }
.align-items-start { align-items: flex-start !important; }
.align-items-end { align-items: flex-end !important; }
.align-items-center { align-items: center !important; }
.flex-grow-1 { flex-grow: 1 !important; }
.flex-shrink-0 { flex-shrink: 0 !important; }
.flex-wrap { flex-wrap: wrap !important; }
.gap-1 { gap: var(--md-sys-spacing-small) !important; }
.gap-2 { gap: var(--md-sys-spacing-medium) !important; }
.gap-3 { gap: var(--md-sys-spacing-large) !important; }

// Dialog styling using Material Design 3 tokens
.mat-mdc-dialog-container {
  --mdc-dialog-container-color: var(--md-sys-color-surface);

  // Form field styling
  .mat-mdc-form-field-label {
    color: var(--md-sys-color-on-surface-variant);
  }

  .mdc-notched-outline__leading,
  .mdc-notched-outline__notch,
  .mdc-notched-outline__trailing {
    border-color: var(--md-sys-color-outline);
  }

  ::placeholder {
    color: var(--md-sys-color-on-surface-variant);
    opacity: 0.7;
  }

  .mat-mdc-select-arrow {
    color: var(--md-sys-color-on-surface-variant);
  }

  .mat-mdc-input-element {
    caret-color: var(--md-sys-color-primary);
    &::placeholder {
      color: var(--md-sys-color-on-surface-variant);
      opacity: 0.7;
    }
  }

  // Dialog container styling
  .mdc-dialog__container,
  .mdc-dialog__surface {
    background-color: var(--md-sys-color-surface);
    border-radius: 28px;
    padding: var(--md-sys-spacing-small);
  }

  .mdc-dialog__surface-scrim {
    background-color: transparent;
  }

  // Dialog content styling
  .mat-mdc-dialog-title {
    color: var(--md-sys-color-on-surface);
    font-size: 1.25rem;
    font-weight: 500;
    padding: var(--md-sys-spacing-medium) var(--md-sys-spacing-medium) var(--md-sys-spacing-small);
  }

  .mat-mdc-dialog-content {
    color: var(--md-sys-color-on-surface-variant);
    padding: 0 var(--md-sys-spacing-medium);

    p {
      margin-bottom: var(--md-sys-spacing-medium);
    }

    .mat-mdc-form-field {
      width: 100%;
      margin-bottom: var(--md-sys-spacing-small);
    }
  }

  // Dialog actions styling
  .mat-mdc-dialog-actions {
    padding: var(--md-sys-spacing-medium);
    justify-content: flex-end;
    gap: var(--md-sys-spacing-small);

    .mat-mdc-button-base {
      &:not(.mat-primary):not(.mat-accent):not(.mat-warn) {
        color: var(--md-sys-color-primary);
      }
    }
  }

  // Form field input styling
  .mat-mdc-form-field {
    .mat-mdc-input-element,
    .mat-mdc-select-value-text,
    .mat-mdc-form-field-label {
      color: var(--md-sys-color-on-surface);
    }
  }
}
